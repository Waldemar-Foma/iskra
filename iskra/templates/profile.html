<!-- templates/profile.html - –£–ª—É—á—à–µ–Ω–Ω—ã–π –ª–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç -->
{% extends "base.html" %}

{% block content %}
<div class="profile-container">
    <!-- –ü—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ -->
    <div class="profile-welcome">
        <h1>–ü—Ä–∏–≤–µ—Ç, <span class="accent">{{ user.username }}</span>!</h1>
        <p>–†–∞–¥—ã –≤–∏–¥–µ—Ç—å –≤–∞—Å —Å–Ω–æ–≤–∞ –≤ —Å–∏–º—É–ª—è—Ü–∏–∏</p>
    </div>
    
    <!-- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ -->
    <div class="profile-stats-grid">
        <div class="stat-card">
            <div class="stat-icon">üìÖ</div>
            <div class="stat-info">
                <span class="stat-label">–° –Ω–∞–º–∏ —Å</span>
                <span class="stat-value">{{ stats.member_since }}</span>
            </div>
        </div>
        
        <div class="stat-card">
            <div class="stat-icon">‚è∞</div>
            <div class="stat-info">
                <span class="stat-label">–ü–æ—Å–ª–µ–¥–Ω–∏–π –≤–∏–∑–∏—Ç</span>
                <span class="stat-value">{{ stats.last_active }}</span>
            </div>
        </div>
        
        <div class="stat-card">
            <div class="stat-icon">üìä</div>
            <div class="stat-info">
                <span class="stat-label">–í–∞—à–∏ —Å–æ–±—ã—Ç–∏—è</span>
                <span class="stat-value">{{ stats.events_count }}</span>
            </div>
        </div>
        
        <div class="stat-card">
            <div class="stat-icon">‚ö°</div>
            <div class="stat-info">
                <span class="stat-label">–ê–∫—Ç–∏–≤–Ω–æ—Å—Ç—å</span>
                <span class="stat-value">{{ '–í—ã—Å–æ–∫–∞—è' if stats.events_count > 10 else '–°—Ä–µ–¥–Ω—è—è' if stats.events_count > 5 else '–ù–∏–∑–∫–∞—è' }}</span>
            </div>
        </div>
    </div>
    
    <!-- –¢–∞–±—ã —Å –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏ -->
    <div class="profile-tabs">
        <button class="tab-btn active" onclick="switchTab('profile')">üë§ –ü—Ä–æ—Ñ–∏–ª—å</button>
        <button class="tab-btn" onclick="switchTab('security')">üîí –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å</button>
        <button class="tab-btn" onclick="switchTab('preferences')">‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏</button>
    </div>
    
    <!-- –í–∫–ª–∞–¥–∫–∞ –ü—Ä–æ—Ñ–∏–ª—å -->
    <div id="tab-profile" class="tab-content active">
        <div class="profile-card">
            <h3>–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ—Ñ–∏–ª—å</h3>
            <form method="POST" action="{{ url_for('profile') }}" class="profile-form">
                <input type="hidden" name="action" value="update_profile">
                
                <div class="form-group">
                    <label for="username">–ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</label>
                    <input type="text" id="username" name="username" value="{{ user.username }}" required>
                </div>
                
                <div class="form-group">
                    <label for="email">Email</label>
                    <input type="email" id="email" name="email" value="{{ user.email }}" required>
                </div>
                
                <button type="submit" class="btn btn-primary">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è</button>
            </form>
        </div>
    </div>
    
    <!-- –í–∫–ª–∞–¥–∫–∞ –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å -->
    <div id="tab-security" class="tab-content">
        <div class="profile-card">
            <h3>–ò–∑–º–µ–Ω–∏—Ç—å –ø–∞—Ä–æ–ª—å</h3>
            <form method="POST" action="{{ url_for('profile') }}" class="profile-form">
                <input type="hidden" name="action" value="update_password">
                
                <div class="form-group">
                    <label for="current_password">–¢–µ–∫—É—â–∏–π –ø–∞—Ä–æ–ª—å</label>
                    <input type="password" id="current_password" name="current_password" required>
                </div>
                
                <div class="form-group">
                    <label for="new_password">–ù–æ–≤—ã–π –ø–∞—Ä–æ–ª—å</label>
                    <input type="password" id="new_password" name="new_password" required>
                    <small class="hint">–ú–∏–Ω–∏–º—É–º 6 —Å–∏–º–≤–æ–ª–æ–≤</small>
                </div>
                
                <div class="form-group">
                    <label for="confirm_password">–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç–µ –ø–∞—Ä–æ–ª—å</label>
                    <input type="password" id="confirm_password" name="confirm_password" required>
                </div>
                
                <button type="submit" class="btn btn-primary">–û–±–Ω–æ–≤–∏—Ç—å –ø–∞—Ä–æ–ª—å</button>
            </form>
        </div>
    </div>
    
    <!-- –í–∫–ª–∞–¥–∫–∞ –ù–∞—Å—Ç—Ä–æ–π–∫–∏ -->
    <div id="tab-preferences" class="tab-content">
        <div class="profile-card">
            <h3>–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞</h3>
            <form method="POST" action="{{ url_for('profile') }}" class="profile-form">
                <input type="hidden" name="action" value="update_preferences">
                
                <div class="form-group checkbox-group">
                    <label>
                        <input type="checkbox" name="notifications" {% if preferences.get('notifications') %}checked{% endif %}>
                        –í–∫–ª—é—á–∏—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
                    </label>
                </div>
                
                <div class="form-group">
                    <label for="theme">–¢–µ–º–∞ –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏—è</label>
                    <select id="theme" name="theme">
                        <option value="dark" {% if preferences.get('theme') == 'dark' %}selected{% endif %}>–¢–µ–º–Ω–∞—è</option>
                        <option value="light" {% if preferences.get('theme') == 'light' %}selected{% endif %}>–°–≤–µ—Ç–ª–∞—è</option>
                        <option value="auto" {% if preferences.get('theme') == 'auto' %}selected{% endif %}>–ö–∞–∫ –≤ —Å–∏—Å—Ç–µ–º–µ</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="language">–Ø–∑—ã–∫</label>
                    <select id="language" name="language">
                        <option value="ru" {% if preferences.get('language') == 'ru' %}selected{% endif %}>–†—É—Å—Å–∫–∏–π</option>
                        <option value="en" {% if preferences.get('language') == 'en' %}selected{% endif %}>English</option>
                    </select>
                </div>
                
                <button type="submit" class="btn btn-primary">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏</button>
            </form>
        </div>
    </div>
</div>

<script>
function switchTab(tab) {
    // –û–±–Ω–æ–≤–ª—è–µ–º —Ç–∞–±—ã
    document.querySelectorAll('.tab-btn').forEach(btn => btn.classList.remove('active'));
    event.target.classList.add('active');
    
    // –û–±–Ω–æ–≤–ª—è–µ–º –∫–æ–Ω—Ç–µ–Ω—Ç
    document.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));
    document.getElementById(`tab-${tab}`).classList.add('active');
}
</script>
{% endblock %}